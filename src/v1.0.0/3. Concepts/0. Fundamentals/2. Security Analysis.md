Security Analysis
===

- [Common Definitions](#common-definitions)
    - [Desiderata](#desiderata)
- [Channels](#channels)
    - [Channel Networks](#channel-networks)
- [Sidechains](#sidechains)
- [Plasma](#plasma)
    - [Plasma MVP](#plasma-mvp)
    - [Plasma Cash](#plasma-cash)
    - [Validium](#validium)
- [Rollups](#rollups)
    - [ZK Rollups](#zk-rollups)
    - [Optimistic Rollups](#optimistic-rollups)
        - [Interactive Verification Games](#interactive-verification-games)

This page will provide a comprehensive overview of the security and scalability properties of Fuel as it compares to other so-called "scaling solutions." It argues that Fuel is uniquely positioned in the trade-off space to be the best scaling architecture today.

Common Definitions
---

We must first begin by establishing common definitions for desirable properties in a scaling solution. The following definitions are informal, but sufficiently precise to enable proper discussion on the matter. Note that they apply to both "layer-2" constructions as well as base "layer-1" blockchains.

**Security** Security can be roughly defined as the cost to manipulate history. Example: the security of Proof-of-Work blockchains can be measured as the capex and opex of producing new blocks. The security of Proof-of-Stake blockchains can be measured [as the penalty that can be applied](https://medium.com/@ercwl/proof-of-stake-is-less-wasteful-b2854a191766) if a history re-organization is done.

**Trustless** Trustlessness has two components: [_state liveness_ and _state safety_](https://arxiv.org/abs/1904.06441). State is live if it can be consumed by its owner in finite time (in other words, it cannot be burned/locked forever), and safe if it cannot be consumed by its non-owners ever (in other words, it cannot be stolen). It is critical to evaluate the trustlessness of a system across both these dimensions, not only state safety.

Decentralized blockchains cannot be completely trustless; to illustrate, consider that 51% of miners in a Proof-of-Work blockchain could censor any future transaction (effectively burning censored funds, which allows for [indirect theft](https://ethresear.ch/t/trustless-validator-blackmailing-with-the-blockchain/6922)) or even re-organize the history from genesis to steal all funds. Therefore we measure trustlessness as _the assumptions under which_ a system is trustless. As an example, if we assume 51% of miners are honest, then a blockchain is trustless. We can describe a system that is almost trustless as another as **trust-minimized** with respect to the other (e.g. a trust-minimized sidechain is trustless under almost the same assumptions as its main chain).

**Permissionless** A system is permissionless if it requires no permission _from inside the system_ to begin participating. It is permissioned otherwise.

**Decentralization** While commonly (and incorrectly) described as "the number of nodes," decentralization is measured as [the cost to run a fully validating node](https://www.truthcoin.info/blog/measuring-decentralization/). While permissionlessness is a necessary property for decentralization, it does not otherwise provide a metric for measuring decentralization. _Note:_ this definition is actually [missing a very important detail](#zk-rollups), but will suffice for now.

**Scalability and Throughput** Often a point of contention an confusion, scalability is front-and-center as the most obvious problem for contemporary blockchains. First, _throughput_ is the total transaction throughput of the system, measured in transactions per second. This is often the metric incorrectly advertized as scalability. _Scalability_ is the ratio of transaction throughput to full node cost for a single user. Therefore, comparing transactions per second between two systems without simultaneously comparing their costs is misguided. It is trivial to increase throughput by simply increasing the cost to run a full node, but that is not an increase to scalability.

The [distinction between throughput and scalability](https://twitter.com/_prestwich/status/1284174486674083840) is that the former is measured across the whole system while the latter is measured from the perspective of a single full node (i.e. user). Additionally, throughput can be increased by using additional trust assumptions, but scalability cannot (since it requires full validation).

Put another way, in the context of scalability, everyone who could ever be interested in a particular interaction must fully validate that interaction (including ones that happen in layer-2 systems). If a layer-2 interaction is cheaper to validate than it would have been to validate on layer-1, then the layer-2 system provides scalability.

As an example, consider a sharded blockchain with two shards, with each shard using the same execution model as Ethereum. The sharded chain would have twice the throughput of Ethereum, but would actually have only half the scalability of Ethereum (since the execution model is the same on each shard as Ethereum, and there are now twice as many transactions to validate). Alternatively, the sharded chain has identical throughput and scalability, and the sharded chain is effectively unsharded. (Yes, this does mean that sharding provides no scalability, and only provides a decentralized throughput increase if a secure light client assumption is added, [which is actually independent of sharding](https://arxiv.org/abs/1809.09044).)

> **Note:** While the _naming_ of the above properties may certainly be debated, that they are desirable properties in any scaling solution, and good metrics for evaluating such solutions, cannot.

### Desiderata

In order to be a "good" layer-2 scaling solution, we desire the following properties:
1. The system must have equal or almost-equal security to the main chain. Non-trivial trade-offs in security are unacceptable from a scaling solution.
1. The system must be trust-minimized. Adding meaningful trust assumptions, similar to reducing security, is unacceptable.
1. The system should be permissionless. This is not a hard requirement, so long as the system is trustless, but it highly desired.
1. The system must be as decentralized as the main chain. This means node costs (for both the main chain and the layer-2 system combined) should not be meaningfully higher (than just the main chain).
1. The system must have higher throughput than the main chain. This means that the total transactional capacity must be higher.
1. The system must be more scalable than the main chain. This means that each user must be able to fully validate more interactions (a generalization of transactions). Combining this and above properties, the system must have a higher total throughput while being trust-minimized and as decentralized as the main chain.
1. Additional desiderata include:
    - No need for hot keys
    - Backups support
    - No novel cryptography
    - Capital efficient
    - Low latency
    - Generalizability/expressivity

Channels
---

Channels are one of the earliest blockchain scaling proposals. Originally taking the form of [payment channels](https://en.bitcoin.it/wiki/Payment_channels), they can be extended to arbitrary computation with [state channels](https://www.jeffcoleman.ca/state-channels).

A fixed set of participants can open a channel with a on-chain transaction that defines the rules of the channel. Updates to the channel state are made by unanimous consent: all participants signing a state update, communicated off-chain. Any participant may attempt to close the channel on a particular state, which starts a timeout during which anyone may submit a later state to penalize a fraudulent channel close attempt. If no later state has been shown by the timeout, the channel closes, settling balances based on the closing state.

Metrics:
1. Same security as the main chain.
1. Additional trust assumption: if the majority of miners censor transactions (which requires attacking the main chain), a proof of fraudulent channel close attempt can be censored, allowing theft of funds. Miners can already indirectly steal funds through censorship of the main chain, so this is not a meaningfully stronger trust assumption.
1. It is permissionless to open a channel, but participation in any specific channel is permissioned and fixed. This means e.g. [Uniswap](https://uniswap.org) cannot be implemented using only channels.
1. Channels increase node costs proportional to the number of additional in-channel interactions a user engages in.
1. The total aggregate throughput can be substantially increased by using channels.
1. Scalability depends on the execution model used in the channel, but it will usually be cheaper to execute a transaction in a channel that it would be to validate it on Ethereum.
1. Additional concerns:
    - Hot keys are required to take advantage of the low latency of channels.
    - Backups are not possible, only copies (backups can recover everything but a delta, while copies are all-or-nothing). Only the latest channel state is useful, and in fact old channel states are worse-than-useless as attempting to close the channel with an old state will result in a penalty.
    - Capital inefficient: funds must be locked up inside a channel before being used, and cannot be unlocked quickly without cooperation from the specific channel participants.
    - Instant finality: as soon as a state update is signed unanimously, it is instantly finalized.
    - Generalizable to contracts between a fixed participant set.

In summary, while trust-minimized, channels make enormous sacrifices across the rest of the board to achieve instant finality, which is a feature not possible with blockchains. As such, unless instant finality is a critical requirement, channels are unsuitable as a scaling solution.

### Channel Networks

https://en.bitcoin.it/wiki/Lightning_Network

Sidechains
---

https://blockstream.com/sidechains.pdf

Plasma
---

https://plasma.io/plasma.pdf

### Plasma MVP

https://ethresear.ch/t/minimal-viable-plasma/426

### Plasma Cash

https://ethresear.ch/t/plasma-cash-plasma-with-much-less-per-user-data-checking/1298

[Lower Bounds for Off-Chain Protocols: Exploring the Limits of Plasma](https://eprint.iacr.org/2020/175)

### Validium

https://ethresear.ch/t/why-do-dont-we-need-two-phase-sends-plus-confirmation/1866

Validium Cash with confirmation signatures (like channels, must have hot keys)

Rollups
---

https://medium.com/@adlerjohn/the-why-s-of-optimistic-rollup-7c6a22cbb61a

https://ethresear.ch/t/against-proof-of-stake-for-zk-op-rollup-leader-election/7698

https://ethresear.ch/t/spam-resistant-block-creator-selection-via-burn-auction/5851

https://github.com/ethereum/research/blob/master/papers/pricing/ethpricing.pdf

### ZK Rollups

https://github.com/barryWhiteHat/roll_up

https://ethresear.ch/t/on-chain-scaling-to-potentially-500-tx-sec-through-mass-tx-validation/3477

### Optimistic Rollups

https://ethresear.ch/t/minimal-viable-merged-consensus/5617

#### Interactive Verification Games

https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-kalodner.pdf

